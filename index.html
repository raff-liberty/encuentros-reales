<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[DEV] Encuentros Reales - Plataforma de Encuentros Adultos</title>
    <link rel="stylesheet" href="styles-new.css">
    <link rel="stylesheet" href="components.css">
</head>

<body>
    <!-- Splash Screen -->
    <div id="splash-screen" class="splash-screen active">
        <div class="splash-content">
            <div class="splash-icon">üîû</div>
            <h1 class="splash-title">Encuentros Reales</h1>
            <p class="splash-subtitle">Plataforma para encuentros reales entre adultos reales</p>
            <div class="splash-warning">
                <p>‚ö†Ô∏è Esta plataforma es exclusivamente para mayores de 18 a√±os</p>
                <p>Todos los usuarios son verificados y todos los encuentros son reales</p>
                <p>No se permiten perfiles falsos ni usuarios fantasma</p>
            </div>
            <button class="btn btn-primary btn-large" onclick="app.closeSplash()">Entrar a la Plataforma</button>
        </div>
    </div>

    <!-- App Container -->
    <div id="app-container" class="app-container hidden">
        <!-- Header -->
        <header class="header">
            <div class="user-greeting">
                <div class="user-avatar" id="header-avatar" onclick="app.showView('profile')" style="cursor: pointer;">
                    <span id="header-avatar-icon">üë§</span>
                </div>
                <div class="user-info" onclick="app.showView('profile')" style="cursor: pointer;">
                    <h3 id="header-username">Usuario</h3>
                    <p id="header-role">Rol</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="icon-btn hidden" id="header-create-event" onclick="app.showCreateEvent()"
                    title="Crear Evento">‚ûï</button>
                <button class="icon-btn" id="notifications-btn" onclick="app.toggleNotifications()"
                    title="Notificaciones">
                    üîî
                    <span id="notifications-badge" class="notification-badge hidden">0</span>
                </button>
                <button class="icon-btn" title="Configuraci√≥n" onclick="app.showView('profile')">‚öôÔ∏è</button>
                <button class="icon-btn" onclick="app.logout()" title="Salir">üö™</button>
            </div>
        </header>

        <!-- Panel de Notificaciones -->
        <div id="notifications-panel" class="notifications-panel hidden">
            <div class="notifications-header">
                <h3>Notificaciones</h3>
                <button class="btn btn-text btn-small" onclick="app.markAllNotificationsAsRead()">Marcar todas como
                    le√≠das</button>
            </div>
            <div id="notifications-list" class="notifications-list">
                <!-- Se llenar√° din√°micamente -->
            </div>
        </div>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <a href="#" class="nav-tab" data-view="explore" onclick="app.showView('explore')">
                <span>üîç</span>
                <span>Explorar</span>
                <span class="badge" id="explore-count">0</span>
            </a>
            <a href="#" class="nav-tab" data-view="applications" onclick="app.showView('applications')">
                <span>üë•</span>
                <span>Mis Postulaciones</span>
                <span class="badge" id="applications-count">0</span>
            </a>
            <a href="#" class="nav-tab" data-view="favorites" onclick="app.showView('favorites')">
                <span>‚ù§Ô∏è</span>
                <span>Favoritos</span>
            </a>
            <a href="#" class="nav-tab" data-view="profile" onclick="app.showView('profile')">
                <span>üë§</span>
                <span>Mi Perfil</span>
            </a>
            <a href="#" class="nav-tab hidden" data-view="admin" onclick="app.showView('admin')">
                <span>‚öôÔ∏è</span>
                <span>Admin</span>
            </a>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Vista: Explorar Eventos -->
            <div id="view-explore" class="view hidden">
                <div class="page-header">
                    <div>
                        <h1>Eventos disponibles</h1>
                        <p>Encuentra el encuentro perfecto para ti</p>
                    </div>
                    <button class="btn btn-secondary" onclick="app.toggleFilters()">
                        <span>üîΩ</span>
                        Filtros
                    </button>
                </div>

                <!-- Filtros -->
                <div id="filters-panel" class="filters-panel hidden">
                    <div class="card">
                        <h3 style="margin-bottom: var(--spacing-md);">Filtrar eventos</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-md);">
                            <div class="form-group">
                                <label>Tipo de evento</label>
                                <select id="filter-type">
                                    <option value="">Todos</option>
                                    <option value="TRADICIONAL">Tradicional</option>
                                    <option value="SUMISO">Sumiso</option>
                                    <option value="ESTRUCTURADO">Estructurado</option>
                                    <option value="LIBERAL">Liberal</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Zona</label>
                                <select id="filter-zone">
                                    <option value="">Todas</option>
                                    <option value="norte">Norte</option>
                                    <option value="sur">Sur</option>
                                    <option value="este">Este</option>
                                    <option value="oeste">Oeste</option>
                                    <option value="centro">Centro</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Nivel de Gangbang</label>
                            <select id="filter-gangbang">
                                <option value="">Cualquiera</option>
                                <option value="SUAVE">Suave</option>
                                <option value="MEDIO">Medio</option>
                                <option value="INTENSO">Intenso</option>
                                <option value="EXTREMO">Extremo</option>
                            </select>
                        </div>
                        <div
                            style="display: flex; justify-content: flex-end; gap: var(--spacing-sm); margin-top: var(--spacing-md);">
                            <button class="btn btn-secondary" onclick="app.toggleFilters()">Cancelar</button>
                            <button class="btn btn-primary" onclick="app.applyFilters()">Aplicar Filtros</button>
                        </div>
                    </div>
                </div>

                <!-- Estad√≠sticas del usuario -->
                <div class="stats-grid" id="user-stats">
                    <!-- Se llenar√°n din√°micamente -->
                </div>

                <!-- Lista de eventos -->
                <div class="events-grid" id="events-list">
                    <!-- Se llenar√°n din√°micamente -->
                </div>
            </div>

            <!-- Vista: Mis Postulaciones -->
            <div id="view-applications" class="view hidden">
                <h1>Mis postulaciones</h1>
                <div class="events-grid" id="applications-list">
                    <!-- Se llenar√°n din√°micamente -->
                </div>
            </div>

            <!-- Vista: Favoritos -->
            <div id="view-favorites" class="view hidden">
                <h1>Favoritos</h1>
                <div class="events-grid" id="favorites-list">
                    <!-- Se llenar√°n din√°micamente -->
                </div>
            </div>

            <!-- Vista: Mi Perfil -->
            <div id="view-profile" class="view hidden">
                <div id="profile-container">
                    <!-- Se llenar√° din√°micamente -->
                </div>
            </div>

            <!-- Vista: Admin -->
            <div id="view-admin" class="view hidden">
                <div id="admin-container">
                    <!-- Se llenar√° din√°micamente -->
                </div>
            </div>

            <!-- Vista: Gesti√≥n de Evento (Oferente) -->
            <div id="view-event-manage" class="view hidden">
                <div id="event-manage-container">
                    <!-- Se llenar√° din√°micamente -->
                </div>
            </div>
            <!-- Vista: Panel de Admin -->
            <div id="view-admin" class="view hidden"></div>
        </main>
    </div>

    <!-- Modal: Login/Registro -->
    <div id="auth-modal" class="modal active">
        <div class="modal-content auth-card">
            <h2 id="auth-title" style="text-align: center; margin-bottom: var(--spacing-lg);">Iniciar Sesi√≥n</h2>

            <form id="auth-form" onsubmit="app.handleAuth(event)">
                <div class="form-group">
                    <label for="auth-email">Email</label>
                    <input type="email" id="auth-email" required placeholder="tu@email.com">
                </div>

                <div class="form-group">
                    <label for="auth-password">Contrase√±a</label>
                    <input type="password" id="auth-password" required placeholder="********">
                </div>

                <!-- Campos de Registro (ocultos por defecto) -->
                <div id="name-group" class="form-group hidden">
                    <label for="auth-username">Nombre de Usuario</label>
                    <input type="text" id="auth-username" placeholder="Elige un alias √∫nico">
                </div>

                <div id="role-group" class="form-group hidden">
                    <label>¬øQu√© buscas?</label>
                    <div class="radio-selector">
                        <label class="radio-option">
                            <input type="radio" name="role" id="auth-role" value="BUSCADOR" checked>
                            <span>Buscador</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="role" value="OFERENTE">
                            <span>Oferente</span>
                        </label>
                    </div>
                </div>

                <button type="submit" id="auth-submit" class="btn btn-primary btn-block btn-large">Entrar</button>

                <p class="text-center" style="margin-top: var(--spacing-md);">
                    <span id="auth-toggle-text">¬øNo tienes cuenta?</span>
                    <a href="#" id="auth-toggle-link" onclick="app.toggleAuthMode()">Reg√≠strate</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Modal: Detalles de Evento -->
    <div id="event-detail-modal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="event-detail-title">Detalles del Evento</h2>
                <button class="modal-close" onclick="app.closeEventDetail()">‚úï</button>
            </div>
            <div id="event-detail-content">
                <!-- Se llenar√° din√°micamente -->
            </div>
            <div class="modal-footer" id="event-detail-actions">
                <!-- Botones de acci√≥n din√°micos -->
            </div>
        </div>
    </div>

    <!-- Modal: Crear Evento -->
    <div id="create-event-modal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>Crear Nuevo Evento</h2>
                <button class="modal-close" onclick="app.closeCreateEvent()">‚úï</button>
            </div>
            <form id="create-event-form" onsubmit="app.handleCreateEvent(event)">
                <div class="form-group">
                    <label for="event-title">T√≠tulo del Evento</label>
                    <input type="text" id="event-title" required>
                </div>
                <div class="form-group">
                    <label for="event-description">Descripci√≥n</label>
                    <textarea id="event-description" rows="4" required></textarea>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-md);">
                    <div class="form-group">
                        <label for="event-date">Fecha</label>
                        <input type="date" id="event-date" required>
                    </div>
                    <div class="form-group">
                        <label for="event-time">Hora</label>
                        <input type="time" id="event-time" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Nivel del Gangbang</label>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-md);">
                        <label class="level-card">
                            <input type="radio" name="gangbang-level" value="TRADICIONAL" required>
                            <div class="level-content">
                                <span>üåä</span>
                                <strong>Tradicional</strong>
                                <small>Fluido y espont√°neo</small>
                            </div>
                        </label>
                        <label class="level-card">
                            <input type="radio" name="gangbang-level" value="SUMISO">
                            <div class="level-content">
                                <span>‚ö°</span>
                                <strong>Sumiso</strong>
                                <small>Rol sumiso potenciado</small>
                            </div>
                        </label>
                        <label class="level-card">
                            <input type="radio" name="gangbang-level" value="ESTRUCTURADO">
                            <div class="level-content">
                                <span>üìã</span>
                                <strong>Estructurado</strong>
                                <small>Orden y turnos definidos</small>
                            </div>
                        </label>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-md);">
                    <div class="form-group">
                        <label for="event-capacity">Capacidad M√°xima</label>
                        <input type="number" id="event-capacity" min="2" max="50" required>
                    </div>
                    <div class="form-group">
                        <label for="event-zone">Zona Aproximada</label>
                        <select id="event-zone" required>
                            <option value="">Seleccionar zona</option>
                            <option value="norte">Zona Norte</option>
                            <option value="sur">Zona Sur</option>
                            <option value="este">Zona Este</option>
                            <option value="oeste">Zona Oeste</option>
                            <option value="centro">Centro</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="event-location">Ubicaci√≥n Exacta (solo visible para aceptados)</label>
                    <input type="text" id="event-location" required>
                </div>
                <div class="form-group">
                    <label for="event-rules">Reglas del Encuentro</label>
                    <textarea id="event-rules" rows="3"
                        placeholder="Ej: Uso obligatorio de protecci√≥n, respeto mutuo, etc."></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Publicar Evento</button>
            </form>
        </div>
    </div>

    <!-- Modal: Valorar Participantes -->
    <div id="rate-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Valorar participantes</h2>
                <button class="modal-close" onclick="app.closeRateModal()">‚úï</button>
            </div>
            <div id="rate-content">
                <!-- Se llenar√° din√°micamente -->
            </div>
        </div>
    </div>



    <!-- Modal: Editar Perfil -->
    <div id="edit-profile-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: var(--spacing-md);">Editar Perfil</h2>
            <form id="edit-profile-form" onsubmit="app.handleProfileEdit(event)">
                <div class="form-group" style="text-align: center;">
                    <label class="form-label">Avatar</label>
                    <img id="edit-avatar-preview" src=""
                        style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin-bottom: 10px;">
                    <br>
                    <button type="button" class="btn btn-secondary btn-small"
                        onclick="document.getElementById('avatar-upload').click()">Cambiar Foto</button>
                    <input type="file" id="avatar-upload" hidden accept="image/*"
                        onchange="app.handleImageUpload('avatar', this)">
                </div>

                <div class="form-group">
                    <label class="form-label">Bio / Sobre m√≠</label>
                    <textarea class="form-input" name="bio" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Zonas de Inter√©s</label>
                    <div class="checkbox-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <label><input type="checkbox" name="zones" value="norte"> Norte</label>
                        <label><input type="checkbox" name="zones" value="sur"> Sur</label>
                        <label><input type="checkbox" name="zones" value="este"> Este</label>
                        <label><input type="checkbox" name="zones" value="oeste"> Oeste</label>
                        <label><input type="checkbox" name="zones" value="centro"> Centro</label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Galer√≠a de Fotos (M√°x 4)</label>
                    <div id="gallery-preview" style="display: flex; gap: 5px; margin-bottom: 10px;"></div>
                    <button type="button" class="btn btn-secondary btn-small"
                        onclick="document.getElementById('gallery-upload').click()">A√±adir Foto a Galer√≠a</button>
                    <input type="file" id="gallery-upload" hidden accept="image/*"
                        onchange="app.handleImageUpload('gallery', this)">
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-text" onclick="app.toggleProfileEdit()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Imagen ampliada -->
    <div id="image-modal" class="modal" onclick="app.closeImageModal()">
        <div class="modal-content"
            style="max-width: 90vw; max-height: 90vh; background: transparent; box-shadow: none; padding: 0;">
            <img id="image-modal-img" src=""
                style="max-width: 100%; max-height: 90vh; object-fit: contain; border-radius: var(--border-radius-lg);">
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-client.js"></script>
    <script src="supabase-service.js"></script>

    <!-- App Scripts (Legacy DataService can be kept as fallback or removed later) -->
    <script src="data.js"></script>
    <script src="app-new-complete.js?v=2.7"></script>
    <script src="applicants-manager.js?v=1.6"></script>
</body>

</html>